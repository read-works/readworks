import{a as K,c as X}from"./chunk-FZYSEXYG.js";import{b as z}from"./chunk-G3MELPCC.js";import{a as G}from"./chunk-5ESBBNVT.js";import{A as S,C as R,Ia as N,Ka as O,M as C,N as s,Ra as F,U as I,Z as h,aa as u,ba as M,ga as D,ia as w,ja as U,ka as r,la as o,ma as L,ob as k,pa as m,qa as B,ra as P,sa as x,ta as y,ua as H,ub as v,vb as $,w as E,wa as l,xa as a,xb as f,y as A,yb as W,z as d}from"./chunk-V52KVE3Z.js";function q(_,p){if(_&1){let e=m();r(0,"rw-alert",8),l("cancellation",function(){d(e);let i=a();return S(i.showAlert=!1);})("confirmation",function(){d(e);let i=a();return i.filterIsSetToInclude?i.includeMatch():i.excludeMatch(),S(i.showAlert=!1);}),r(1,"span"),x(2,0),o()();}_&2&&u("type","warning")("showCancelBtn",!0)("fastLaneAllowed",!0);}function J(_,p){if(_&1){let e=m();r(0,"div",7)(1,"div",9)(2,"div",10)(3,"rw-button",11),l("clicked",function(){let i=d(e).$implicit,n=a();return S(n.addWordsToList(i.text));}),o(),r(4,"rw-button",12),l("clicked",function(){let i=d(e).$implicit,n=a();return S(n.showMatchingPages.emit(i.text));}),o(),r(5,"span",13),N(6),o(),r(7,"span",14),N(8),o()()()();}if(_&2){let e=p.$implicit,t=a();s(),M("width",e.share+"%")("background-color",t.barColor),s(2),u("error",t.selectedWords.includes(e.text)&&!t.filterIsSetToInclude)("success",t.selectedWords.includes(e.text)&&t.filterIsSetToInclude)("icon",t.filterIsSetToInclude?"file-earmark-check":"file-earmark-excel"),s(3),O(" ",e.count,"x "),s(2),O(" ",e.text," ");}}var V=(()=>{class _{distributions=[];barColor="transparent";selectedWordsChange=new R();filtered=new R();showMatchingPages=new R();Array=Array;filterIsSetToInclude=!1;showAlert=!1;selectedWords=[];switchFilterMode(){this.filterIsSetToInclude=!this.filterIsSetToInclude;}ngOnInit(){this.initialize();}ngOnChanges(){this.initialize();}initialize(){let e=0;this.distributions.forEach(t=>{e=t.count>e?t.count:e;}),this.distributions.forEach(t=>{t.share=t.count/e*100;});}addWordsToList(e){this.selectedWords.includes(e)?this.selectedWords=this.selectedWords.filter(t=>t!==e):this.selectedWords.push(e);}excludeMatch(){this.selectedWords.length<=0||(this.filtered.emit({filterIsSetToInclude:this.filterIsSetToInclude,selectedWords:this.selectedWords}),this.distributions=this.distributions.filter(e=>!this.selectedWords.includes(e.text)),this.selectedWords=[]);}includeMatch(){this.selectedWords.length<=0||(this.filtered.emit({filterIsSetToInclude:this.filterIsSetToInclude,selectedWords:this.selectedWords}),this.distributions=this.distributions.filter(e=>this.selectedWords.includes(e.text)),this.selectedWords=[]);}trackByFunc(e,t){return t.text;}static ɵfac=function(t){return new(t||_)();};static ɵcmp=I({type:_,selectors:[["rw-result-distribution-chart"]],hostBindings:function(t,i){t&1&&l("keydown.f",function(){return i.switchFilterMode();},!1,C);},inputs:{distributions:"distributions",barColor:"barColor"},outputs:{selectedWordsChange:"selectedWordsChange",filtered:"filtered",showMatchingPages:"showMatchingPages"},features:[A],decls:8,vars:5,consts:()=>{let e;e="Change filter mode (F)";let t;t="Reset current selection";let i;i="Apply filter rule";let n;n="Apply";let c;c="Are you sure you want to apply this filter rule?";let b;b="Exclude this word as match, now and for future occurrences";let g;return g="Show pages containing exactly this word as match",[c,[3,"type","showCancelBtn","fastLaneAllowed"],[1,"text-lg","py-1.5","flex","items-center","whitespace-nowrap","bg-slate-900/90","sticky","top-0","z-10"],[1,"ml-1.5","flex","items-center","bg-black/20","rounded-md"],["title",e,"styling","main_outline",1,"scale-75","inline-block",3,"clicked","icon"],["title",t,"icon","x-lg","styling","main_outline",1,"scale-75","inline-block","-mr-[11px]",3,"clicked","error","disabled"],["icon","play","title",i,"styling","standard","label",n,1,"scale-75","inline-block","w-40","-mr-3",3,"clicked","disabled"],[1,"rounded-md","overflow-x-hidden","bg-gradient-to-r","from-indigo-100/20","to-indigo-300/0","dark:bg-gradient-to-r","dark:from-indigo-900/40","dark:to-indigo-950/0","bg-opacity-30","my-1"],[3,"cancellation","confirmation","type","showCancelBtn","fastLaneAllowed"],[1,"rounded-md","bar","cursor-pointer","transition-all","duration-500"],[1,"text-lg","py-1.5","px-1.5","flex","items-center","whitespace-nowrap"],["title",b,1,"scale-75","inline-block","mr-px",3,"clicked","error","success","icon"],["title",g,"icon","eye",1,"scale-75","inline-block","mr-2",3,"clicked"],[1,"shadow","mr-1.5","inline-block","rounded-md","bg-white/25","dark:bg-black/25","text-black","dark:text-white","text-xs","py-1.5","px-2","text-center"],[1,"shadow","ml-1.5","inline-block","rounded-md","bg-white/25","dark:bg-black/25","px-1.5","py-0","text-center","text-black","dark:text-white"]];},template:function(t,i){t&1&&(h(0,q,3,3,"rw-alert",1),r(1,"div",2)(2,"div",3)(3,"rw-button",4),l("clicked",function(){return i.switchFilterMode();}),o(),r(4,"rw-button",5),l("clicked",function(){return i.selectedWords.length=0;}),o(),r(5,"rw-button",6),l("clicked",function(){return i.showAlert=!0;}),o()()(),w(6,J,9,9,"div",7,i.trackByFunc,!0)),t&2&&(D(i.showAlert?0:-1),s(3),u("icon",i.filterIsSetToInclude?"file-earmark-excel":"file-earmark-check"),s(),u("error",!0)("disabled",!i.selectedWords.length),s(),u("disabled",!i.selectedWords.length),s(),U(i.distributions));},dependencies:[f,W],styles:["@keyframes _ngcontent-%COMP%_grow{0%{width:0}}.bar[_ngcontent-%COMP%]{background:#0f0;animation:_ngcontent-%COMP%_grow ease-out;animation-duration:.13s;animation-duration:.16s;animation-duration:.19s;animation-duration:.22s;animation-duration:.25s;animation-duration:.28s;animation-duration:.31s;animation-duration:.34s;animation-duration:.37s;animation-duration:.4s}"]});}return _;})();var Q=_=>[_];function Y(_,p){if(_&1){let e=m();r(0,"rw-result-distribution-chart",12),l("showMatchingPages",function(i){d(e);let n=a(2);return S(n.showMatchingPages(i));})("filtered",function(i){d(e);let n=a(2);return S(n.onFilter(i));}),o();}if(_&2){let e=a(2);u("distributions",e.distributions)("barColor",e.barColor);}}function Z(_,p){if(_&1&&(r(0,"main",10),h(1,Y,1,2,"rw-result-distribution-chart",11),o()),_&2){let e=a();s(),D(e.distributions&&e.distributions.length?1:-1);}}var Ie=(()=>{class _{searchService=E(z);iaService=E(v);socket=E(G);router=E(k);document;forCase=!1;closed=new R();close(){this.iaService.is(this.iaLayer)&&this.closed.next();}currentSearch;distributions;barColor="transparent";lastSelection=[];iaLayer="result-distribution-"+new Date().getTime();constructor(){this.iaService.add(this.iaLayer),this.socket.fromEvent("update").subscribe(e=>{if(["searchResultExcluded"].includes(e.name)){let t=this.lastSelection;this.lastSelection=[],this.showDistributionFor(t);}});}ngOnInit(){this.showDistributionFor([this.document.searchMatches[0].id]);}ngOnDestroy(){this.iaService.take(this.iaLayer);}showDistributionFor(e){e[0]!==this.lastSelection[0]&&(this.lastSelection=e,this.document.searchMatches.some(t=>{if(t.id===e[0])return this.currentSearch=t,!0;}),this.currentSearch&&(this.barColor=K.getColor(this.currentSearch.query),this.forCase?this.searchService.searchDistributionForCase(this.currentSearch?.id,this.document.caseId).subscribe(t=>{this.distributions=t;let i=0;this.distributions.forEach(n=>{i+=n.count;}),this.distributions.forEach(n=>{n.share=n.count/i;});}):this.searchService.searchDistributionForDocument(this.currentSearch?.id,this.document.id).subscribe(t=>{this.distributions=t;let i=0;this.distributions.forEach(n=>{i+=n.count;}),this.distributions.forEach(n=>{n.share=n.count/i;});})));}onFilter(e){this.searchService.applyFilter(e.selectedWords,this.lastSelection[0],this.document.id,this.forCase,e.filterIsSetToInclude);}showMatchingPages(e){this.close(),setTimeout(()=>{this.router.navigate([`/cases/${this.document.caseId}/pages/${this.document.id}/${this.lastSelection[0]}/${e}`]);},30);}static ɵfac=function(t){return new(t||_)();};static ɵcmp=I({type:_,selectors:[["rw-result-distribution"]],hostBindings:function(t,i){t&1&&l("keydown.d",function(c){return i.close(c);},!1,C)("keydown.escape",function(c){return i.close(c);},!1,C);},inputs:{document:"document",forCase:"forCase"},outputs:{closed:"closed"},decls:12,vars:11,consts:()=>{let e;e="Close result distribution browser (ESC)";let t;return t=" Searchmatch distribution for ",[t,[1,"lex-1","flex","flex-col","overflow-hidden","h-full"],[1,"relative","z-10","flex-shrink-0","h-16","text-white","border-b","border-slate-200","dark:border-slate-700","shadow-sm","flex","items-center"],[1,"transition-all","duration-75","grow","pl-3","text-base","sm:text-lg","md:text-2xl"],[1,"capitalize"],["icon","x-lg","title",e,"styling","standard_outline",1,"mr-3",3,"clicked"],[1,"context"],[1,"items-center","pt-3","pb-1.5","pl-3","pr-2.5"],[3,"selected","roundedTop","roundedBottom","interactive","searchMatches","initialSelections","size","multi"],[1,"flex-1","flex","items-stretch","overflow-hidden","px-3"],[1,"flex-1","overflow-y-auto","h-full","pr-1","pl-0.5"],[3,"distributions","barColor"],[3,"showMatchingPages","filtered","distributions","barColor"]];},template:function(t,i){t&1&&(r(0,"rw-overlay")(1,"div",1)(2,"div",2)(3,"h3",3),B(4,0),L(5,"span",4),P(),o(),r(6,"rw-button",5),l("clicked",function(){return i.closed.emit();}),o()(),r(7,"div",6)(8,"div",7)(9,"rw-word-bar",8),l("selected",function(c){return i.showDistributionFor(c);}),o()()(),r(10,"div",9),h(11,Z,2,1,"main",10),o()()()),t&2&&(s(5),y(i.document.originalName.replace(".pdf","")),H(4),s(4),u("roundedTop",!0)("roundedBottom",!0)("interactive",!0)("searchMatches",i.document.searchMatches)("initialSelections",F(9,Q,i.document.searchMatches[0].id))("size","medium")("multi",!1),s(2),D(i.currentSearch?11:-1));},dependencies:[f,X,$,V],encapsulation:2});}return _;})();export{Ie as a};/**i18n:1964dde12af7df15d0053ab7761c4e4c56fe7eae085ef9e01bc7588ce5d2189d*/