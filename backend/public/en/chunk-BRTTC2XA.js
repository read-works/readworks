import{a as x}from"./chunk-D6QVSENV.js";import{a as V}from"./chunk-GVGBDAZ3.js";import{a as k}from"./chunk-5ESBBNVT.js";import{b as K}from"./chunk-PM5VPY4S.js";import{A as T,Fa as L,Ga as $,Ia as l,Ja as M,Ka as w,N as r,Qa as y,T as A,U as R,Z as f,aa as E,ga as G,ka as _,la as i,ma as S,na as m,oa as d,pa as h,qa as b,ra as P,sa as F,sb as U,va as v,w as N,wa as C,xa as p,xb as B,y as I,yb as H,z as D}from"./chunk-V52KVE3Z.js";var q=["console"],W=(()=>{class o{output="";console=A("console");ngAfterViewInit(){setTimeout(()=>{this.ngOnChanges();},250);}ngOnChanges(){let e=this.console();e&&(e.nativeElement.scrollTop=e.nativeElement.scrollHeight);}static ɵfac=function(t){return new(t||o)();};static ɵcmp=R({type:o,selectors:[["rw-console"]],viewQuery:function(t,n){t&1&&L(n.console,q,5),t&2&&$();},inputs:{output:"output"},features:[I],decls:3,vars:1,consts:[["console",""],[1,"h-[148px]","mt-3","pt-3","px-1.5","bg-black/75","dark:bg-indigo-700/25","rounded-lg","shadow-inner","dark:shadow-none","overflow-hidden","overflow-y-auto","hover:overflow-x-auto","text-xs","text-white","text-left","font-mono","transition-all","duration-150","opacity-30","dark:opacity-70","hover:opacity-100"]],template:function(t,n){t&1&&(_(0,"pre",1,0),l(2),i()),t&2&&(r(2),w("",n.output,`
`));},encapsulation:2});}return o;})();var z=()=>[];function Q(o,Y){if(o&1){let e=h();_(0,"rw-alert",25),C("confirmation",function(){D(e);let n=p();return T(n.finalizeMigration());}),S(1,"rw-progress-bar",26)(2,"rw-console",27),i();}if(o&2){let e=p();E("type","processing")("confirmBtnDisabled",e.percentCompleted!==1),r(),E("percentCompleted",e.percentCompleted),r(),E("output",e.output);}}var se=(()=>{class o{migrationService=N(x);electronService=N(U);socket=N(k);dataCompatibleVersion;databaseVersion;percentCompleted=0;output="";constructor(){this.migrationService.fetchIsMigrationNecessary().subscribe(e=>{this.databaseVersion=e.appVersion,this.dataCompatibleVersion=e.databaseVersion;}),this.socket.fromEvent("migrationMetaData").subscribe(e=>{this.output=e.output||"",this.percentCompleted=e.percentCompleted||0;});}startMigration(){this.percentCompleted=1e-8,this.migrationService.startMigration();}finalizeMigration(){this.percentCompleted=0,this.output="",this.electronService.send("restartApp");}shutdown(){this.electronService.send("shutdown");}static ɵfac=function(t){return new(t||o)();};static ɵcmp=R({type:o,selectors:[["rw-screen-migration"]],decls:33,vars:7,consts:()=>{let e;e="Start Migration";let t;t="Quit";let n;n=" Migration ";let s;s=" Migration required to use the latest app version ";let O;O="A migration must be completed before you can proceed with your work.";let c;c="Your stored data is actually compatible with the version:";let g;g="This software version requires database migration to version:";let u;return u=" Please be aware that the migration process may take some time. During this period, the app must not be closed, and the computer should not enter standby mode. "+"[\uFFFD#24\uFFFD\uFFFD/#24\uFFFD|\uFFFD#25\uFFFD\uFFFD/#25\uFFFD|\uFFFD#26\uFFFD\uFFFD/#26\uFFFD|\uFFFD#27\uFFFD\uFFFD/#27\uFFFD]"+""+"[\uFFFD#24\uFFFD\uFFFD/#24\uFFFD|\uFFFD#25\uFFFD\uFFFD/#25\uFFFD|\uFFFD#26\uFFFD\uFFFD/#26\uFFFD|\uFFFD#27\uFFFD\uFFFD/#27\uFFFD]"+" Ensure that you have sufficient time to complete the migration. If not, please exit the app and perform the migration at a later time. "+"[\uFFFD#24\uFFFD\uFFFD/#24\uFFFD|\uFFFD#25\uFFFD\uFFFD/#25\uFFFD|\uFFFD#26\uFFFD\uFFFD/#26\uFFFD|\uFFFD#27\uFFFD\uFFFD/#27\uFFFD]"+""+"[\uFFFD#24\uFFFD\uFFFD/#24\uFFFD|\uFFFD#25\uFFFD\uFFFD/#25\uFFFD|\uFFFD#26\uFFFD\uFFFD/#26\uFFFD|\uFFFD#27\uFFFD\uFFFD/#27\uFFFD]"+" You will be informed about the progress throughout the migration process. ",u=v(u),[n,s,O,c,g,u,[3,"showQr","navItems"],["header",""],[1,"flex-grow","pl-3","pt-1.5","md:pt-0","capitalize","text-2xl","md:text-4xl","mt-3"],["main",""],[3,"type","confirmBtnDisabled"],[1,"mt-6","max-w-[640px]"],[1,"text-3xl","text-amber-500","dark:text-amber-400","font-light","mb-3"],[1,"pt-6"],[1,"mb-3","text-lg"],[1,"flex","text-lg","mb-3"],[1,"flex-grow"],[1,"font-bold"],[1,"flex","text-lg","mb-6"],[1,"bg-amber-400/50","border-2","border-amber-400","p-3","rounded","mb-6","text-black"],[1,"flex"],[1,"w-1/2","pr-1.5"],["label",e,"icon","gear","styling","standard",3,"clicked"],[1,"w-1/2","pl-1.5"],["label",t,"icon","door-open","styling","standard",3,"clicked","error"],[3,"confirmation","type","confirmBtnDisabled"],[3,"percentCompleted"],[3,"output"]];},template:function(t,n){t&1&&(_(0,"rw-page",6),m(1,7),_(2,"h3",8),F(3,0),i(),d(),m(4,9),f(5,Q,3,4,"rw-alert",10),_(6,"div",11)(7,"h3",12),F(8,1),i(),_(9,"div",13)(10,"p",14),F(11,2),i(),_(12,"div",15)(13,"span",16),F(14,3),i(),_(15,"span",17),l(16),i()(),_(17,"div",18)(18,"span",16),F(19,4),i(),_(20,"span",17),l(21),i()(),_(22,"div",19),b(23,5),S(24,"br")(25,"br")(26,"br")(27,"br"),P(),i(),_(28,"div",20)(29,"div",21)(30,"rw-button",22),C("clicked",function(){return n.startMigration();}),i()(),_(31,"div",23)(32,"rw-button",24),C("clicked",function(){return n.shutdown();}),i()()()()(),d(),i()),t&2&&(E("showQr",!1)("navItems",y(6,z)),r(5),G(n.percentCompleted?5:-1),r(11),M(n.dataCompatibleVersion),r(5),M(n.databaseVersion),r(11),E("error",!0));},dependencies:[K,H,V,W,B],encapsulation:2});}return o;})();export{se as a};/**i18n:1964dde12af7df15d0053ab7761c4e4c56fe7eae085ef9e01bc7588ce5d2189d*/